let streak = 0; // new variable for streak
let baseScore = 0; // normal correct answers count

function startQuiz() {
  currentIndex = 0;
  baseScore = 0;
  score = 0;
  streak = 0;
  scoreDisplay.textContent = `Score: ${score} / ${questions.length}`;
  feedbackEl.textContent = '';
  nextBtn.classList.add('hidden');
  showQuestion();
}

function selectAnswer(selected, correct, btn, manual=true) {
  clearInterval(timerInterval);
  const buttons = optionsDiv.querySelectorAll('button');
  buttons.forEach(b => b.disabled = true);

  if(selected === correct){
    if(manual) {
      baseScore++;
      streak++;
      score += streak; // add streak bonus to total score
    }
    feedbackEl.textContent = `✅ Correct! Streak: ${streak} (+${streak} pts)`;
    if(btn) btn.classList.add('correct');
    correctSound.play();
  } else {
    feedbackEl.textContent = selected===null 
      ? `⏰ Time's up! Correct: ${correct}` 
      : `❌ Wrong! Correct: ${correct}`;
    if(btn) btn.classList.add('wrong');
    buttons.forEach(b => { if(b.textContent === correct) b.classList.add('correct'); });
    streak = 0; // reset streak
    wrongSound.play();
  }

  scoreDisplay.textContent = `Score: ${score} / ${questions.length + calculateMaxStreakBonus()}`;
  nextBtn.classList.remove('hidden');
}

// helper function to calculate max potential streak bonus for display
function calculateMaxStreakBonus() {
  let n = questions.length;
  return (n*(n+1))/2 - n; // maximum possible bonus if all answers correct
}
